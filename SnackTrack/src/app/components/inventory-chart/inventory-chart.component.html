<ion-card>
  <ion-card-header>
    <ion-card-title>
      <ion-icon name="analytics-outline" color="tertiary"></ion-icon>
      Inventar-Visualisierung
    </ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <!-- Nur noch Lagerpl채tze verf체gbar -->
    <h3>Verteilung nach Lagerpl채tzen</h3>

    @if(inventoryStats$ | async; as stats){
    <div class="chart-container">
      <!-- Lagerpl채tze Chart -->
      <div class="chart-section">
        <div class="progress-chart">
          @for(location of getStorageLocations(); track location.location_id){
          <div class="progress-item">
            <div class="progress-header">
              <div class="progress-label">
                <span>{{ location.name }}</span>
              </div>
              <div class="progress-value">
                {{ stats.itemsByLocation[location.location_id] || 0 }} /
                {{ stats.totalItems }}
                <small
                  >({{
                    getPercentage(
                      stats.itemsByLocation[location.location_id] || 0,
                      stats.totalItems
                    )
                  }}%)</small
                >
              </div>
            </div>
            <ion-progress-bar 
              [value]="
                getProgress(
                   stats.itemsByLocation[location.location_id] || 0,
                  stats.totalItems
                )
              ">
            </ion-progress-bar>
          </div>
          }
        </div>
      </div>




      <!-- Zusammenfassung -->
      <div class="chart-summary">
        <ion-chip color="primary" outline="true">
          <ion-icon name="pie-chart-outline"></ion-icon>
          <ion-label>Gesamt: {{ stats.totalItems }} Artikel</ion-label>
        </ion-chip>

        @if(stats.expiringSoonCount > 0){
        <ion-chip
          color="warning"
          outline="true"
        >
          <ion-icon name="warning-outline"></ion-icon>
          <ion-label>{{ stats.expiringSoonCount }} bald ablaufend</ion-label>
        </ion-chip>
        }
      </div>
    </div>
    }

  </ion-card-content>
</ion-card>
