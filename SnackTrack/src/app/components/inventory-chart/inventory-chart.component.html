<ion-card>
  <ion-card-header>
    <ion-card-title>
      <ion-icon name="analytics-outline" color="tertiary"></ion-icon>
      Inventar-Visualisierung
    </ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <!-- Nur noch Lagerpl채tze verf체gbar -->
    <h3>Verteilung nach Lagerpl채tzen</h3>

    @if(isLoading) {
      <div class="loading">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Lade Inventar-Statistiken...</p>
      </div>
    } @else {
      <div class="chart-container">
        <!-- Lagerpl채tze Chart -->
        <div class="chart-section">
          <div class="progress-chart">
            @for(location of getStorageLocations(); track location.location_id) {
              <div class="progress-item">
                <div class="progress-header">
                  <div class="progress-label">
                    <span>{{ location.name }}</span>
                  </div>
                  <div class="progress-value">
                    {{ inventoryStats.itemsByLocation[location.location_id] || 0 }} /
                    {{ inventoryStats.totalItems }}
                    <small
                      >({{
                        getPercentage(
                          inventoryStats.itemsByLocation[location.location_id] || 0,
                          inventoryStats.totalItems
                        )
                      }}%)</small
                    >
                  </div>
                </div>
                <ion-progress-bar
                  [value]="
                    getProgress(
                       inventoryStats.itemsByLocation[location.location_id] || 0,
                      inventoryStats.totalItems
                    )
                  ">
                </ion-progress-bar>
              </div>
            }
          </div>
        </div>

        <!-- Zusammenfassung -->
        <div class="chart-summary">
          <ion-chip color="primary" outline="true">
            <ion-icon name="pie-chart-outline"></ion-icon>
            <ion-label>Gesamt: {{ inventoryStats.totalItems }} Artikel</ion-label>
          </ion-chip>

          @if(inventoryStats.expiringSoonCount > 0) {
            <ion-chip color="warning" outline="true">
              <ion-icon name="warning-outline"></ion-icon>
              <ion-label>{{ inventoryStats.expiringSoonCount }} bald ablaufend</ion-label>
            </ion-chip>
          }

          @if(inventoryStats.mostUsedLocation) {
            <ion-chip color="tertiary" outline="true">
              <ion-icon name="home-outline"></ion-icon>
              <ion-label>Meist genutzt: {{ inventoryStats.mostUsedLocation.name }}</ion-label>
            </ion-chip>
          }
        </div>
      </div>
    }

  </ion-card-content>
</ion-card>
